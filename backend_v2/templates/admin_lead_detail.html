{% extends "admin_base.html" %}

{% block title %}Lead #{{ lead.id }} · THE13TH Admin{% endblock %}

{% block content %}
<div class="px-10 py-8 space-y-8">
  <!-- Top bar -->
  <div class="flex items-center justify-between">
    <div>
      <p class="text-xs tracking-[0.3em] text-amber-300/70 uppercase">Lead intelligence</p>
      <h1 class="mt-2 text-3xl font-semibold text-amber-100">
        Lead #{{ lead.id }}
      </h1>
      <p class="mt-1 text-sm text-amber-200/70">
        Full context for a single lead pulled straight from THE13TH ingestion pipeline.
      </p>
    </div>

    <div class="flex items-center gap-3">
      <a
        href="/admin/leads/{{ lead.id }}/journey"
        class="inline-flex items-center px-4 py-2 text-xs font-medium tracking-wide text-amber-50 uppercase rounded-full
               bg-gradient-to-r from-fuchsia-600/80 via-purple-500/80 to-amber-500/80
               shadow-[0_0_40px_rgba(236,72,153,0.45)] hover:shadow-[0_0_55px_rgba(251,191,36,0.6)]
               transition-all duration-200"
      >
        View lead journey →
      </a>

      <a
        href="/admin/leads"
        class="inline-flex items-center px-4 py-2 text-xs font-medium tracking-wide text-amber-200/80 uppercase rounded-full
               border border-amber-500/40 hover:bg-amber-500/5 transition-colors duration-200"
      >
        Back to leads
      </a>
    </div>
  </div>

  <!-- Main grid -->
  <div class="grid grid-cols-12 gap-8">
    <!-- Left: Lead profile -->
    <div class="col-span-12 lg:col-span-7">
      <div
        class="relative overflow-hidden rounded-3xl bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0.04),_rgba(15,23,42,0.9))]
               border border-purple-500/40 shadow-[0_0_40px_rgba(147,51,234,0.35)]"
      >
        <div class="absolute inset-0 opacity-40 pointer-events-none"
             style="background: radial-gradient(circle at 0% 0%, rgba(236, 72, 153, 0.4), transparent 55%),
                              radial-gradient(circle at 100% 100%, rgba(251, 191, 36, 0.25), transparent 55%);">
        </div>

        <div class="relative px-8 py-6 space-y-6">
          <div class="flex items-center justify-between gap-4">
            <div>
              <p class="text-xs tracking-[0.25em] text-amber-300/70 uppercase">Summary</p>
              <h2 class="mt-1 text-xl font-semibold text-amber-100">Lead profile</h2>
            </div>
            <div class="flex items-center gap-2">
              <span
                class="inline-flex items-center px-3 py-1 text-[0.65rem] font-semibold tracking-wide uppercase rounded-full
                       bg-emerald-500/15 text-emerald-300 border border-emerald-400/40"
              >
                {{ (lead.status or "NEW") | upper }}
              </span>
            </div>
          </div>

          <dl class="grid grid-cols-1 gap-4 text-sm md:grid-cols-2">
            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Full name</dt>
              <dd class="text-base text-amber-50">{{ lead.full_name or "—" }}</dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Email</dt>
              <dd class="text-base text-amber-50">
                {% if lead.email %}
                  <a href="mailto:{{ lead.email }}" class="hover:underline text-amber-100">
                    {{ lead.email }}
                  </a>
                {% else %}
                  —
                {% endif %}
              </dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Phone</dt>
              <dd class="text-base text-amber-50">{{ lead.phone or "—" }}</dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Assigned agent</dt>
              <dd class="text-base text-amber-50">
                {{ lead.assigned_agent or "—" }}
              </dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Tenant</dt>
              <dd class="text-base text-amber-50">
                {{ lead.tenant_key or "demo-brokerage" }}
              </dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Source</dt>
              <dd class="text-base text-amber-50">
                {{ lead.source or "—" }}
              </dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">External ID</dt>
              <dd class="text-base text-amber-50">
                {{ lead.external_id or "—" }}
              </dd>
            </div>

            <div class="space-y-1">
              <dt class="text-xs font-medium tracking-wide text-amber-300/70 uppercase">Created at</dt>
              <dd class="text-base text-amber-50">
                {{ lead.created_at or "—" }}
              </dd>
            </div>
          </dl>
        </div>
      </div>
    </div>

    <!-- Right: Raw payload -->
    <div class="col-span-12 lg:col-span-5">
      <div
        class="relative h-full overflow-hidden rounded-3xl bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0.85),_rgba(10,0,20,0.98))]
               border border-purple-500/40 shadow-[0_0_40px_rgba(147,51,234,0.35)]"
      >
        <div class="absolute inset-0 opacity-40 pointer-events-none"
             style="background: radial-gradient(circle at 10% 0%, rgba(236, 72, 153, 0.35), transparent 55%),
                              radial-gradient(circle at 100% 100%, rgba(251, 191, 36, 0.25), transparent 55%);">
        </div>

        <div class="relative px-8 py-6 space-y-4">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-xs font-medium tracking-[0.25em] text-amber-300/70 uppercase">
                Source payload
              </p>
              <h2 class="mt-1 text-lg font-semibold text-amber-100">
                Raw ingestion payload
              </h2>
              <p class="mt-1 text-xs text-amber-200/70">
                Exact data as received from the original source
                (webhook or CSV). Ideal for debugging mapping issues and confirming upstream fields.
              </p>
            </div>
          </div>

          <div
            class="mt-3 rounded-2xl border border-amber-500/30 bg-black/40 px-4 py-3 text-xs font-mono text-amber-100
                   overflow-x-auto max-h-[280px]"
          >
            <pre class="whitespace-pre-wrap break-all">
{{ lead.raw_payload | tojson(indent=2) if lead.raw_payload is not none else "{}" }}
            </pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
